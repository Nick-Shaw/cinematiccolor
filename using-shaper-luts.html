<!DOCTYPE HTML>
<html lang="EN">
 <head>
  <title>
   Using Shaper LUTs
  </title>
  <meta content="Using Shaper LUTs" name="description"/>
  <meta content="cinematic-color" name="keywords"/>
  <meta content="document" name="resource-type"/>
  <meta content="global" name="distribution"/>
  <meta content="text/html; charset=utf8" http-equiv="Content-Type"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="LaTeX2HTML v2019" name="Generator"/>
  <link href="half-float-luts.html" rel="next"/>
  <link href="d-luts.html" rel="previous"/>
  <link href="half-float-luts.html" rel="next"/>
  <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="assets/css/custom.css" rel="stylesheet" type="text/css"/>
 </head>
 <body>
  <nav class="navbar navbar-expand-md navbar-dark bg-dark">
   <a class="navbar-brand" href="#">
    Cinematic Color 2
   </a>
   <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbarSupportedContent" data-toggle="collapse" type="button">
    <span class="navbar-toggler-icon">
    </span>
   </button>
   <div class="collapse navbar-collapse" id="navbar">
    <ul class="navbar-nav mr-auto">
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="foreword.html" id="foreword" role="button">
       Foreword
      </a>
      <div aria-labelledby="foreword" class="dropdown-menu">
       <a class="dropdown-item" href="description.html">
        Description
       </a>
       <a class="dropdown-item" href="authorship.html">
        Authorship
       </a>
       <a class="dropdown-item" href="on-web.html">
        On the Web
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="introduction.html" id="introduction" role="button">
       Introduction
      </a>
      <div aria-labelledby="introduction" class="dropdown-menu">
       <a class="dropdown-item" href="intended-audience.html">
        Intended Audience
       </a>
       <a class="dropdown-item" href="how-read-this-document.html">
        How to Read this Document
       </a>
       <a class="dropdown-item" href="goal.html">
        The Goal
       </a>
       <a class="dropdown-item" href="converging-approaches.html">
        Converging Approaches
       </a>
       <a class="dropdown-item" href="general-model-color-processing.html">
        A General Model of Color Processing
       </a>
       <a class="dropdown-item" href="color-management-challenges.html">
        Color Management Challenges
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="color-science.html" id="color-science" role="button">
       Color Science
      </a>
      <div aria-labelledby="color-science" class="dropdown-menu">
       <a class="dropdown-item" href="about-color-science.html">
        About Color Science
       </a>
       <a class="dropdown-item" href="electromagnetic-spectrum.html">
        Electromagnetic Spectrum
       </a>
       <a class="dropdown-item" href="human-visual-system.html">
        Human Visual System
       </a>
       <a class="dropdown-item" href="basic-colorimetry.html">
        Basic Colorimetry
       </a>
       <a class="dropdown-item" href="advanced-colorimetry.html">
        Advanced Colorimetry
       </a>
       <a class="dropdown-item" href="representing-color.html">
        Representing Color
       </a>
       <a class="dropdown-item" href="color-imaging-systems.html">
        Color Imaging Systems
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="workflow.html" id="workflow" role="button">
       Workflow
      </a>
      <div aria-labelledby="workflow" class="dropdown-menu">
       <a class="dropdown-item" href="about-workflow.html">
        About Workflow
       </a>
       <a class="dropdown-item" href="academy-color-encoding-system-aces.html">
        Academy Color Encoding System (ACES)
       </a>
       <a class="dropdown-item" href="look.html">
        The Look
       </a>
       <a class="dropdown-item" href="on-set.html">
        On Set
       </a>
       <a class="dropdown-item" href="visual-effects-animation-games.html">
        Visual Effects, Animation and Games
       </a>
       <a class="dropdown-item" href="compositing.html">
        Compositing
       </a>
       <a class="dropdown-item" href="di-grading.html">
        DI Grading
       </a>
       <a class="dropdown-item" href="critical-monitoring.html">
        Critical Monitoring
       </a>
       <a class="dropdown-item" href="finishing.html">
        Finishing
       </a>
       <a class="dropdown-item" href="archives.html">
        Archives
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="appendix.html" id="appendix" role="button">
       Appendix
      </a>
      <div aria-labelledby="appendix" class="dropdown-menu">
       <a class="dropdown-item" href="common-rgb-color-encodings.html">
        Common RGB Color Encodings
       </a>
       <a class="dropdown-item" href="opencolorio-ocio.html">
        OpenColorIO (OCIO)
       </a>
       <a class="dropdown-item" href="colour-science-python.html">
        Colour Science for Python
       </a>
       <a class="dropdown-item" href="luts-transforms.html">
        LUTs and Transforms
       </a>
       <a class="dropdown-item" href="asc-cdl.html">
        ASC CDL
       </a>
       <a class="dropdown-item" href="aces-ctl.html">
        ACES CTL
       </a>
       <a class="dropdown-item" href="full-legal-ranges.html">
        Full and Legal ranges
       </a>
       <a class="dropdown-item" href="chroma-decoupling.html">
        Chroma Decoupling
       </a>
       <a class="dropdown-item" href="camera-characterization.html">
        Camera Characterization
       </a>
       <a class="dropdown-item" href="file-formats.html">
        File Formats
       </a>
       <a class="dropdown-item" href="software.html">
        Software
       </a>
       <a class="dropdown-item" href="acknowledgements.html">
        Acknowledgements
       </a>
      </div>
     </li>
     <li class="nav-item dropdown" class_="nav-item">
      <a class="nav-link" href="glossary.html">
       Glossary
      </a>
     </li>
     <li class="nav-item dropdown" class_="nav-item">
      <a class="nav-link" href="bibliography.html">
       Bibliography
      </a>
     </li>
    </ul>
    <form class="form-inline my-2 my-md-0">
     <input class="form-control" placeholder="Search" type="text"/>
    </form>
   </div>
  </nav>
  <!-- Content -->
  <div class="container-fluid">
   <div class="row">
    <div class="col-md-12 px-3 py-3">
     <h2>
      <a id="SECTION00643000000000000000">
       Using Shaper LUTs
      </a>
     </h2>
     <p>
      All lookup tables are a sampling of some underlying function, whether that function is explicitly known or not. For example, the function f(x) = 1 / (1 + e-1.5x)  is a mathematical function that can be evaluated for any input values of x. The function can also be represented using a small lookup table over a particular domain by evaluating the function at various intervals. Table x shows a small lookup table with 5 samples representing the function over the input range of -5 to 5.
Input
Output
-5.00
0.001
-2.50
0.023
0.00
0.500
2.50
0.977
5.00
0.999
     </p>
     <p>
      When plotting the table values as in Figure X one can see the sample point output values in the lookup table correspond exactly to the output values of the underlying function. The limitation of lookup tables, however, is that values between the sample points must be interpolated from values within the table.
     </p>
     <p>
      Figure X shows the results of using linear interpolation to determine the output values between the sample points.  The figure illustrates how if care is not taken in choosing the location of the samples it can lead to a substantial error between the output of the lookup table and the result that would have been obtained using the underlying function the table was intended to model. This is particularly true in where the underlying function exhibits a high degree of curvature between the samples. Another limitation of lookup tables is that the output for values outside the input range (e.g. -5 to 5) used to build the lookup table are undefined.
     </p>
     <p>
      When building lookup tables, care should be taken to choose optimal locations for the table samples to minimize the error associated with the interpolation. Figure X shows an example of a table with optimal, non-uniform set of sample points. It should be noted that only a few lookup table formats (e.g. Academy CLF and Cinespace) support non-uniform sampling but the example below shows how the error can be minimized when sample points are chosen with respect to the function they are intended emulate.
     </p>
     <p>
      In the example above, the node placement is optimized to minimize error uniformly across the entire domain. Depending on exactly what the values on the x-axis and y-axis of the graph represent, it may not yield the best results to minimize error in this fashion.  Often in VFX and HDR workflows, due to the nature of the human visual system, it&rsquo;s more visually appealing to minimize the error in a visually uniform space. A quick and dirty way to do this is to logarithmically distribute the sample points. This will shift the largest errors to the brighter parts of the pictures where the eye is less capable of discerning the error.  Figure X shows the function and logarithmically distributed point sampling.
     </p>
     <p>
      The concept of optimal placement of sample points can be extended to 3D LUTs where it is common to wrap a 3D LUT in a matched set of 1D &lsquo;shaper&rsquo; LUTs.  Say the ceiling is set at a pixel value of 100.0. Dividing this into equally sampled regions for a 32x32x32 LUT yields a cell size of about 3. Assuming a reasonable exposure transform, almost all perceptually significant results are going to be compressed into the few lowest cells, wasting the majority of the data set and using potentially inaccurate interpolation over the large steps in those lowest cells. It is preferable to place the samples in the most visually significant locations, which typically occur closer to the dark end of the gamut. This is achieved by wrapping the 3D lookup-table transform with a matched pair of 1D shaper LUTs. The ideal shaper LUT maps the input HDR color space to a normalized, perceptually uniform color space. The 3D LUT is then applied. After the 3D transform the image may be mapped through a further 1D transform, such as the inverse of the original 1D LUT, mapping the pixel data back into the original dynamic range.
     </p>
     <p>
      This second shaper is only necessary for transforms such as those from linear to linear. If the transform is linear to log, or linear to `video&rsquo;, only an input shaper is normally needed. Shaper LUTs may be separate files, applied sequentially with the 3D LUT, or may be included in a single 1D+3D combined LUT.
     </p>
     <p>
     </p>
     <div class="navigation">
      <br/>
      <b>
       Next:
      </b>
      <a href="half-float-luts.html">
       Half Float LUTs
      </a>
      <b>
       Up:
      </b>
      <a href="luts-transforms.html">
       LUTs and Transforms
      </a>
      <b>
       Previous:
      </b>
      <a href="d-luts.html">
       1D LUTs
      </a>
      &nbsp;
      <b>
       <a href="contents.html" id="tex2html957">
        Contents
       </a>
      </b>
     </div>
    </div>
   </div>
  </div>
  <!-- Footer -->
  <footer class="page-footer font-small">
   <div class="footer-copyright text-center py-3">
    Copyright &copy; 2019 &ndash; Cinematic Color Authors &ndash;
    <a href="mailto:ves-tech-color@googlegroups.com">
     ves-tech-color@googlegroups.com
    </a>
   </div>
  </footer>
  <script src="assets/js/jquery.min.js">
  </script>
  <script src="assets/js/popper.min.js">
  </script>
  <script src="assets/js/bootstrap.min.js">
  </script>
 </body>
</html>
