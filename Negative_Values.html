<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2018 (Released Feb 1, 2018) -->
<HTML>
<HEAD>
<TITLE>Negative Values</TITLE>
<META NAME="description" CONTENT="Negative Values">
<META NAME="keywords" CONTENT="cinematic-color">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2018">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="cinematic-color.css">

<LINK REL="next" HREF="Working_with_Log_Imagery.html">
<LINK REL="previous" HREF="Scene_Referred_Linear_Compo.html">
<LINK REL="up" HREF="Compositing.html">
<LINK REL="next" HREF="Working_with_Log_Imagery.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1753"
  HREF="Working_with_Log_Imagery.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1749"
  HREF="Compositing.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1743"
  HREF="Scene_Referred_Linear_Compo.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1751"
  HREF="Contents.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1754"
  HREF="Working_with_Log_Imagery.html">Working with Log Imagery</A>
<B> Up:</B> <A NAME="tex2html1750"
  HREF="Compositing.html">Compositing</A>
<B> Previous:</B> <A NAME="tex2html1744"
  HREF="Scene_Referred_Linear_Compo.html">Scene-Referred Linear Compositing Challenges</A>
 &nbsp; <B>  <A NAME="tex2html1752"
  HREF="Contents.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00553000000000000000">
Negative Values</A>
</H2>
<P>
<BIG CLASS="LARGE">A frame from ‘The Avengers: Infinity War”. The frame in the original Alexa LogC encoding (top), The frame transformed to ACEScc with negative values in shown as purple fringing visible in particular on the top right light (middle) and the final frame (bottom)
© 2018 MARVEL
</BIG>
<P>
<BIG CLASS="LARGE">CIE 1931 2° Standard Observer chromaticity plot of the image above
The above image contains pixel values which are positive in ALEXA Wide Gamut but negative in ACEScg as they are outside of the ACEScg gamut. This results in overly strong purple fringing and clamped values when viewed through an ACES Output Transform. The frame above the light shows the issue clearly. Even pixel values which are on or near the inside of the gamut boundary can result in artifacts. There are a number of potential approaches to solving this problem. Working in the original camera encoding gamut, ALEXA Wide Gamut in this case, is one option. Creating a technical grade for the shot which removes the artifact, and providing that as a LUT for use in VFX is another. With that option, it will be obvious if anything in compositing makes the artifact reappear.
</BIG>
<P>
<BIG CLASS="LARGE">Negative values may occur in a scene-referred linear color if the working gamut is smaller than, or even just different from, the encoding gamut of the plate. In some extreme examples, cameras have been found to produce values outside of their specified encoding gamut. That could lead to negative scene-referred linear values even without transforming away from the camera’s encoding gamut. Like NaNs and Inf values, this comes with the territory. Don’t just clip these values! These negative values can pass through some operations without causing issues and should normally be preserved when delivering VFX renders to DI. However, the results of some mathematical operations used in compositing are undefined for negative numbers and may create NaNs or Infs, or push a small negative value to a much larger one. Sometimes, where negative values will be clamped by the final display transform, it may be safe to clamp them in the comp. This is a risky strategy though. Changes to the grade may make the clamping visible, causing artifacts such as black holes in the image. It is generally preferable to use an approach such as offsetting the values before an operation to make everything positive and then subtracting the offset afterward. Remember that compositing should be a no-op for unaffected pixels, so even if a pixel value represents an unreal color in the plate, the VFX shot should be returned to DI with values representing that same unreal color, matching the original plate.
</BIG>
<P>
<BIG CLASS="LARGE">This is also something to watch out for in games. As mentioned in Section 3.4.3 Games, games may render in less precise “small” floating-point formats when an alpha channel is not needed and performance and memory bandwidth are more important than precision. It is important to remember that these floating point formats do not have a sign bit so do not support negative numbers, and thus cannot store out-of-gamut colors. If asked to do so, clipping will silently occur. Care must be taken to either choose the appropriate floating-point format, handle negative values explicitly or bring out-of-gamut values into the working gamut to avoid the silent artefacts that would otherwise occur.
</BIG>
<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1753"
  HREF="Working_with_Log_Imagery.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1749"
  HREF="Compositing.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1743"
  HREF="Scene_Referred_Linear_Compo.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1751"
  HREF="Contents.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html1754"
  HREF="Working_with_Log_Imagery.html">Working with Log Imagery</A>
<B> Up:</B> <A NAME="tex2html1750"
  HREF="Compositing.html">Compositing</A>
<B> Previous:</B> <A NAME="tex2html1744"
  HREF="Scene_Referred_Linear_Compo.html">Scene-Referred Linear Compositing Challenges</A>
 &nbsp; <B>  <A NAME="tex2html1752"
  HREF="Contents.html">Contents</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
