<!DOCTYPE HTML>
<html lang="EN">
 <head>
  <title>
   Chroma Decoupling
  </title>
  <meta content="Chroma Decoupling" name="description"/>
  <meta content="cinematic-color" name="keywords"/>
  <meta content="document" name="resource-type"/>
  <meta content="global" name="distribution"/>
  <meta content="text/html; charset=utf8" http-equiv="Content-Type"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="LaTeX2HTML v2019" name="Generator"/>
  <link href="camera-characterization.html" rel="next"/>
  <link href="full-legal-ranges.html" rel="previous"/>
  <link href="camera-characterization.html" rel="next"/>
  <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="assets/css/custom.css" rel="stylesheet" type="text/css"/>
 </head>
 <body>
  <nav class="navbar navbar-expand-md navbar-dark bg-dark">
   <a class="navbar-brand" href="#">
    Cinematic Color 2
   </a>
   <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbarSupportedContent" data-toggle="collapse" type="button">
    <span class="navbar-toggler-icon">
    </span>
   </button>
   <div class="collapse navbar-collapse" id="navbar">
    <ul class="navbar-nav mr-auto">
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="foreword.html" id="foreword" role="button">
       Foreword
      </a>
      <div aria-labelledby="foreword" class="dropdown-menu">
       <a class="dropdown-item" href="description.html">
        Description
       </a>
       <a class="dropdown-item" href="authorship.html">
        Authorship
       </a>
       <a class="dropdown-item" href="on-web.html">
        On the Web
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="introduction.html" id="introduction" role="button">
       Introduction
      </a>
      <div aria-labelledby="introduction" class="dropdown-menu">
       <a class="dropdown-item" href="intended-audience.html">
        Intended Audience
       </a>
       <a class="dropdown-item" href="how-read-this-document.html">
        How to Read this Document
       </a>
       <a class="dropdown-item" href="goal.html">
        The Goal
       </a>
       <a class="dropdown-item" href="converging-approaches.html">
        Converging Approaches
       </a>
       <a class="dropdown-item" href="general-model-color-processing.html">
        A General Model of Color Processing
       </a>
       <a class="dropdown-item" href="color-management-challenges.html">
        Color Management Challenges
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="color-science.html" id="color-science" role="button">
       Color Science
      </a>
      <div aria-labelledby="color-science" class="dropdown-menu">
       <a class="dropdown-item" href="electromagnetic-spectrum.html">
        Electromagnetic Spectrum
       </a>
       <a class="dropdown-item" href="human-visual-system.html">
        Human Visual System
       </a>
       <a class="dropdown-item" href="basic-colorimetry.html">
        Basic Colorimetry
       </a>
       <a class="dropdown-item" href="advanced-colorimetry.html">
        Advanced Colorimetry
       </a>
       <a class="dropdown-item" href="representing-color.html">
        Representing Color
       </a>
       <a class="dropdown-item" href="color-imaging-systems.html">
        Color Imaging Systems
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="workflow.html" id="workflow" role="button">
       Workflow
      </a>
      <div aria-labelledby="workflow" class="dropdown-menu">
       <a class="dropdown-item" href="academy-color-encoding-system-aces.html">
        Academy Color Encoding System (ACES)
       </a>
       <a class="dropdown-item" href="look.html">
        The Look
       </a>
       <a class="dropdown-item" href="on-set.html">
        On Set
       </a>
       <a class="dropdown-item" href="visual-effects-animation-games.html">
        Visual Effects, Animation and Games
       </a>
       <a class="dropdown-item" href="compositing.html">
        Compositing
       </a>
       <a class="dropdown-item" href="di-grading.html">
        DI Grading
       </a>
       <a class="dropdown-item" href="critical-monitoring.html">
        Critical Monitoring
       </a>
       <a class="dropdown-item" href="finishing.html">
        Finishing
       </a>
       <a class="dropdown-item" href="archives.html">
        Archives
       </a>
      </div>
     </li>
     <li class="nav-item dropdown">
      <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="appendix.html" id="appendix" role="button">
       Appendix
      </a>
      <div aria-labelledby="appendix" class="dropdown-menu">
       <a class="dropdown-item" href="common-rgb-color-encodings.html">
        Common RGB Color Encodings
       </a>
       <a class="dropdown-item" href="opencolorio-ocio.html">
        OpenColorIO (OCIO)
       </a>
       <a class="dropdown-item" href="colour-science-python.html">
        Colour Science for Python
       </a>
       <a class="dropdown-item" href="luts-transforms.html">
        LUTs and Transforms
       </a>
       <a class="dropdown-item" href="asc-cdl.html">
        ASC CDL
       </a>
       <a class="dropdown-item" href="aces-ctl.html">
        ACES CTL
       </a>
       <a class="dropdown-item" href="full-legal-ranges.html">
        Full and Legal ranges
       </a>
       <a class="dropdown-item" href="chroma-decoupling.html">
        Chroma Decoupling
       </a>
       <a class="dropdown-item" href="camera-characterization.html">
        Camera Characterization
       </a>
       <a class="dropdown-item" href="file-formats.html">
        File Formats
       </a>
       <a class="dropdown-item" href="software.html">
        Software
       </a>
       <a class="dropdown-item" href="acknowledgements.html">
        Acknowledgements
       </a>
      </div>
     </li>
     <li class="nav-item dropdown" class_="nav-item">
      <a class="nav-link" href="glossary.html">
       Glossary
      </a>
     </li>
     <li class="nav-item dropdown" class_="nav-item">
      <a class="nav-link" href="bibliography.html">
       Bibliography
      </a>
     </li>
    </ul>
    <form class="form-inline my-2 my-md-0">
     <input class="form-control" placeholder="Search" type="text"/>
    </form>
   </div>
  </nav>
  <!-- Content -->
  <div class="container-fluid">
   <div class="row">
    <div class="col-md-12 px-3 py-3">
     <h1>
      <a id="SECTION00680000000000000000">
       Chroma Decoupling
      </a>
     </h1>
     <p>
      Due to the human visual system&rsquo;s greater sensitivity to detail in luminance than color, it is common to convert image data to a color opponent encoding such as Y&prime;CBCR and to subsample the chroma channels in order to reduce bandwidth and storage requirements with minimal impact on the appearance of the image. While this is useful for monitoring and delivery, within a VFX pipeline it is preferable to maintain full resolution in all channels. A reduction in chroma resolution which is imperceptible to the eye, may have a negative impact on keying and other image processing.
ITU-R BT.709 specifies the transform from R&prime;G&prime;B&prime; (note the primes, indicating that the image data is non-linearly encoded, not scene-referred linear) to Y&prime;CBCR for HDTV, and these are the equations used by default in most software encoders and decoders, and almost all hardware implementations. The equations are as follows:
	E&prime;Y = 0.2126&times;E&prime;R + 0.7152&times;E&prime;G + 0.0722&times;E&prime;B
	E&prime;CB =  (E&prime;B &minus; E&prime;Y) / 1.8556
	E&prime;CR =  (E&prime;R &minus; E&prime;Y) / 1.5748
Where E&prime;R, E&prime;G and E&prime;B are the non-linearly coded R&prime;G&prime;B&prime; values ranged 0-1, and E&prime;Y, E&prime;CB and E&prime;CR are the resulting luma (it is important to differentiate this from luminance) and color difference signals. The luma is ranged 0-1 and the two color difference signals are ranged &minus;0.5 to 0.5.
The coefficients in the luma equation are derived from the second line of the Normalised Primary Matrix (RGB to CIE XYZ matrix) for the Rec. 709 primaries with D65 white, rounded to four decimal places. These are the coefficients which would convert scene-referred linear RGB to CIE luminance. Thus E&prime;Y is an approximation of a non-linear coding of the relative luminance of a Rec. 709 color. For achromatic colors (R = G = B) it matches exactly.
When integer coded for transmission over SDI or HDMI, or storage in a file, these values are mapped to integer using the following equations:
	D&prime;Y = round((219&times;E&prime;Y + 16)&times;2(n &minus; 8))
	D&prime;CB = round((224&times;E&prime;CB + 128)&times;2(n &minus; 8))
	D&prime;CR = round((224&times;E&prime;CR + 128)&times;2(n &minus; 8))
Where n is the bit depth.
JPEG coding uses a variation on this, where the 0-1 of the luma signal is mapped to the entire 0-255 range, and the &minus;0.5 to 0.5 of the chroma components is mapped to 0-256, and the values then clamped to the 0-255 range for storage as 8 bit integer. But JPEG uses the older ITU-R BT.601 luma weightings (0.299, 0.587 and 0.114).
ITU-R BT.2020 specifies a different set of equations, with luma weighting coefficients derived from the Rec. 2020 primaries. It also defines two different color difference codings.
The first is referred to as &ldquo;non-constant luminance&rdquo; because it follows the form of the Rec. 709 coding, where Y&prime; is not a non-linear encoding of relative luminance (a weighted sum of linear R, G and B) but rather is a weighted sum of the already non-linearly encoded R&prime;, G&prime; and B&prime;. The equations are as follows:
	Y' = 0.2627&times;R'  0.6780&times;G'  0.0593&times;B'
	C&prime;B = (B&prime; &minus; Y&prime;) / 1.8814
	C&prime;R = (R&prime; &minus; Y&prime;) / 1.4746
The second is referred to as &ldquo;constant luminance&rdquo; encoding, and takes linear R, G and B as input. The equations are as follows:
	Y&prime;C = f(0.2627&times;R  0.6780&times;G  0.0593&times;B)
Where f(x) is the non-linear encoding function (the Rec. 2020 OETF, as given in Section 4.1.4). R, G and B are then non-linearly encoded with the same function to produce R&prime;, G&prime; and B&prime;, and the colour difference signals calculated as follows:
	if NB &le; B&prime; &minus; Y&prime;C &le; 0:
C&prime;BC = (B&prime; &minus; Y&prime;C ) / &minus;2&times;NB
else if 0 &lt; B&prime; &minus; Y&prime;C &le; PB :
	C&prime;BC = (B&prime; &minus; Y&prime;C ) / 2&times;PB
	if NR &le; R&prime; &minus; Y&prime;C &le; 0:
C&prime;RC = (R&prime; &minus; Y&prime;C ) / &minus;2&times;NR
else if 0 &lt; R&prime; &minus; Y&prime;C &le; PR :
	C&prime;RC = (R&prime; &minus; Y&prime;C ) / 2&times;PR
Where the constants are given precisely in the spec, but it is also noted that for practical purposes the following values can be used:
	PB = 0.7910
NB = 0.9702
PR = 0.4969
NR = 0.8591
ITU-R BT.2020 specifies a new color difference encoding for HDR,  ICTCP.This is referred to as &ldquo;constant intensity&rdquo; encoding, and was originally developed by Dolby. This encoding first transforms linear RGB, range 0-1, to LMS using the following equations:
	L = (1688&times;R + 2146&times;G + 262&times;B) / 4096
M = (683&times;R + 2951&times;G + 462&times;B) / 4096
S = (99&times;R + 309&times;G + 3688&times;B) / 4096
These are then non-linearly encoded using either the PQ inverse EOTF or the HLG OETF, as appropriate, to produce L&prime;M&prime;S&prime;, which is encoded as  ICTCP using the following equations:
	I = 0.5L' + 0.5M'
	CT = (6610&times;L' &minus;13613&times;M' + 7003&times;S') / 4096
CP = (17933&times;L' &minus; 17390&times;M' &minus; 543&times;S') / 4096
Integer coding of all these uses the same method as given above for ITU-R BT.709. ITU-R BT.2020 additionally specifies a &ldquo;full range&rdquo; integer coding, as opposed to the standard coding (referred to as &ldquo;narrow range&rdquo;, see Section 4.7.1) where the luma / intensity component is encoded using:
	D = round((2n &minus; 1)&times;E&prime;)
and the chroma components using:
	D = round((2n &minus; 1)&times;E&prime; + 2(n &minus; 1))
     </p>
     <p>
      Writing in progress&hellip;
     </p>
     <p>
     </p>
     <div class="navigation">
      <br/>
      <b>
       Next:
      </b>
      <a href="camera-characterization.html">
       Camera Characterization
      </a>
      <b>
       Up:
      </b>
      <a href="appendix.html">
       Appendix
      </a>
      <b>
       Previous:
      </b>
      <a href="full-range.html">
       Full Range
      </a>
      &nbsp;
      <b>
       <a href="contents.html" id="tex2html967">
        Contents
       </a>
      </b>
     </div>
    </div>
   </div>
  </div>
  <!-- Footer -->
  <footer class="page-footer font-small">
   <div class="footer-copyright text-center py-3">
    Copyright &copy; 2019 &ndash; Cinematic Color Authors &ndash;
    <a href="mailto:ves-tech-color@googlegroups.com">
     ves-tech-color@googlegroups.com
    </a>
   </div>
  </footer>
  <script src="assets/js/jquery.min.js">
  </script>
  <script src="assets/js/popper.min.js">
  </script>
  <script src="assets/js/bootstrap.min.js">
  </script>
 </body>
</html>
